<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>üêç Berkay'ƒ±n Yƒ±lan Oyunu üêç</title>
  <style>
    body {
      background: #111;
      color: white;
      text-align: center;
      font-family: Arial, sans-serif;
    }
    h1 {
      margin: 10px 0;
    }
    #gameCanvas {
      border: 2px solid lime;
      background: black;
      display: block;
      margin: 10px auto;
    }
    .btn {
      background: lime;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
      font-size: 16px;
      border-radius: 6px;
    }
    .controls {
      margin-top: 15px;
    }
    #settings {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #00bfff;
      border-radius: 8px;
      padding: 5px 10px;
      cursor: pointer;
    }
    #settingsMenu {
      display: none;
      background: #222;
      border: 2px solid lime;
      padding: 15px;
      position: absolute;
      top: 50px;
      right: 10px;
      border-radius: 10px;
      text-align: left;
    }
    label {
      display: block;
      margin: 8px 0;
    }
  </style>
</head>
<body>
  <h1>üêç Berkay'ƒ±n Yƒ±lan Oyunu üêç</h1>
  <p>Skor: <span id="score">0</span> | En Y√ºksek: <span id="highScore">0</span></p>
  <canvas id="gameCanvas" width="400" height="400"></canvas>

  <div>
    <button id="startBtn" class="btn">‚ñ∂ Ba≈üla</button>
  </div>

  <div class="controls">
    <button class="btn" onclick="changeDirection('LEFT')">‚¨Ö</button><br>
    <button class="btn" onclick="changeDirection('UP')">‚¨Ü</button>
    <button class="btn" onclick="changeDirection('DOWN')">‚¨á</button>
    <button class="btn" onclick="changeDirection('RIGHT')">‚û°</button>
  </div>

  <div id="settings">‚öôÔ∏è</div>
  <div id="settingsMenu">
    <label>
      <input type="checkbox" id="musicToggle" checked> M√ºzik A√ß/Kapat
    </label>
    <label for="speedSelect">Hƒ±z:</label>
    <select id="speedSelect">
      <option value="150">Yava≈ü</option>
      <option value="100" selected>Normal</option>
      <option value="70">Hƒ±zlƒ±</option>
    </select>
  </div>

  <audio id="bgMusic" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const startBtn = document.getElementById("startBtn");
    const scoreEl = document.getElementById("score");
    const highScoreEl = document.getElementById("highScore");
    const settingsBtn = document.getElementById("settings");
    const settingsMenu = document.getElementById("settingsMenu");
    const musicToggle = document.getElementById("musicToggle");
    const bgMusic = document.getElementById("bgMusic");
    const speedSelect = document.getElementById("speedSelect");

    let snake, food, dx, dy, score, gameInterval;
    let highScore = localStorage.getItem("highScore") || 0;
    highScoreEl.textContent = highScore;

    function initGame() {
      snake = [{x: 200, y: 200}];
      dx = 20; dy = 0;
      score = 0;
      scoreEl.textContent = score;
      spawnFood();
    }

    function spawnFood() {
      food = {
        x: Math.floor(Math.random() * 20) * 20,
        y: Math.floor(Math.random() * 20) * 20
      };
    }

    function drawGame() {
      ctx.fillStyle = "black";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "red";
      ctx.beginPath();
      ctx.arc(food.x + 10, food.y + 10, 10, 0, Math.PI * 2);
      ctx.fill();

      ctx.fillStyle = "lime";
      snake.forEach(p => ctx.fillRect(p.x, p.y, 20, 20));

      const head = {x: snake[0].x + dx, y: snake[0].y + dy};
      snake.unshift(head);

      if (head.x === food.x && head.y === food.y) {
        score++;
        scoreEl.textContent = score;
        if (score > highScore) {
          highScore = score;
          localStorage.setItem("highScore", highScore);
          highScoreEl.textContent = highScore;
        }
        if (score % 5 === 0) {
          canvas.style.background = canvas.style.background === "black" ? "#222" : "black";
        }
        spawnFood();
      } else {
        snake.pop();
      }

      if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
          snake.slice(1).some(p => p.x === head.x && p.y === head.y)) {
        clearInterval(gameInterval);
        startBtn.textContent = "‚Üª Tekrar Oyna";
      }
    }

    function changeDirection(dir) {
      if (dir === "LEFT" && dx === 0) {dx = -20; dy = 0;}
      else if (dir === "UP" && dy === 0) {dx = 0; dy = -20;}
      else if (dir === "RIGHT" && dx === 0) {dx = 20; dy = 0;}
      else if (dir === "DOWN" && dy === 0) {dx = 0; dy = 20;}
    }

    startBtn.addEventListener("click", () => {
      initGame();
      clearInterval(gameInterval);
      gameInterval = setInterval(drawGame, parseInt(speedSelect.value));
      bgMusic.play();
      startBtn.textContent = "Oynanƒ±yor...";
    });

    settingsBtn.addEventListener("click", () => {
      settingsMenu.style.display = settingsMenu.style.display === "block" ? "none" : "block";
    });

    musicToggle.addEventListener("change", () => {
      if (musicToggle.checked) bgMusic.play();
      else bgMusic.pause();
    });

    speedSelect.addEventListener("change", () => {
      if (gameInterval) {
        clearInterval(gameInterval);
        gameInterval = setInterval(drawGame, parseInt(speedSelect.value));
      }
    });

    document.addEventListener("keydown", e => {
      if (e.key === "ArrowLeft") changeDirection("LEFT");
      else if (e.key === "ArrowUp") changeDirection("UP");
      else if (e.key === "ArrowRight") changeDirection("RIGHT");
      else if (e.key === "ArrowDown") changeDirection("DOWN");
    });
  </script>
</body>
</html>
