
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Uzaktan EriÅŸim (Deneme)</title>
  <style>
    body { font-family: Arial; text-align: center; background: #111; color: #eee; }
    video { width: 45%; margin: 5px; border: 2px solid #444; border-radius: 8px; }
    textarea, input { width: 90%; margin: 5px; }
    button { margin: 5px; padding: 8px 15px; border-radius: 8px; border: none; cursor: pointer; }
    #localVideo { background: #222; }
    #remoteVideo { background: #333; }
  </style>
</head>
<body>
  <h2>ðŸ“¡ Uzaktan BaÄŸlantÄ± (WebRTC)</h2>

  <video id="localVideo" autoplay playsinline muted></video>
  <video id="remoteVideo" autoplay playsinline></video>

  <div>
    <button onclick="start()">ðŸŽ¥ KamerayÄ± AÃ§</button>
    <button onclick="createOffer()">ðŸ“¤ Teklif (Offer) OluÅŸtur</button>
    <button onclick="createAnswer()">ðŸ“¥ YanÄ±t (Answer) OluÅŸtur</button>
  </div>

  <textarea id="offer" placeholder="Offer/Answer buraya yapÄ±ÅŸtÄ±r"></textarea>
  <textarea id="answer" placeholder="Cevap buraya yapÄ±ÅŸtÄ±r"></textarea>
  <button onclick="setRemote()">ðŸ”— BaÄŸla</button>

  <h3>ðŸ’¬ MesajlaÅŸma</h3>
  <input id="msgBox" placeholder="Mesaj yaz...">
  <button onclick="sendMsg()">GÃ¶nder</button>
  <pre id="chat"></pre>

  <script>
    let pc = new RTCPeerConnection();
    let dataChannel = pc.createDataChannel("chat");

    const localVideo = document.getElementById("localVideo");
    const remoteVideo = document.getElementById("remoteVideo");
    const chat = document.getElementById("chat");

    // Kamera aÃ§
    async function start() {
      let stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
      stream.getTracks().forEach(track => pc.addTrack(track, stream));
      localVideo.srcObject = stream;
      pc.ontrack = e => remoteVideo.srcObject = e.streams[0];
    }

    // DataChannel mesaj al
    dataChannel.onmessage = e => chat.innerText += "KarÅŸÄ± taraf: " + e.data + "\n";

    // Gelen baÄŸlantÄ± kabul et
    pc.ondatachannel = e => {
      e.channel.onmessage = ev => chat.innerText += "KarÅŸÄ± taraf: " + ev.data + "\n";
    };

    // Teklif oluÅŸtur
    async function createOffer() {
      let offer = await pc.createOffer();
      await pc.setLocalDescription(offer);
      document.getElementById("offer").value = JSON.stringify(offer);
    }

    // YanÄ±t oluÅŸtur
    async function createAnswer() {
      let offer = JSON.parse(document.getElementById("offer").value);
      await pc.setRemoteDescription(new RTCSessionDescription(offer));
      let answer = await pc.createAnswer();
      await pc.setLocalDescription(answer);
      document.getElementById("answer").value = JSON.stringify(answer);
    }

    // Remote baÄŸla
    async function setRemote() {
      let answer = JSON.parse(document.getElementById("answer").value);
      await pc.setRemoteDescription(new RTCSessionDescription(answer));
    }

    // Mesaj gÃ¶nder
    function sendMsg() {
      let msg = document.getElementById("msgBox").value;
      dataChannel.send(msg);
      chat.innerText += "Sen: " + msg + "\n";
      document.getElementById("msgBox").value = "";
    }
  </script>
</body>
    </html>
